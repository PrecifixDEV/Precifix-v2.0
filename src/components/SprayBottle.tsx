import React from 'react';

interface SprayBottleVisualProps {
    percentage: number; // 0 a 100
}

const SprayBottleVisual: React.FC<SprayBottleVisualProps> = ({ percentage }) => {
    const safePercentage = Math.max(0, Math.min(100, percentage));

    // Cores
    const colorProduct = "#EAB308"; // Amarelo
    const colorWater = "#3B82F6";   // Azul

    // Paths (Mantidos os mesmos)
    const pathSolido = "M 322.00 1637.89 C264.98,1632.91 222.07,1622.51 201.17,1608.62 C191.84,1602.41 185.43,1595.19 183.51,1588.72 C182.17,1584.22 182.00,1533.55 182.00,1147.57 C182.01,685.94 182.00,686.59 186.50,656.77 C187.35,651.12 188.47,643.58 188.99,640.00 C191.15,625.02 197.77,594.57 201.06,584.50 C208.00,563.21 214.39,545.23 217.89,537.14 C223.31,524.61 237.03,498.40 243.21,488.77 L 248.19 481.00 L 362.50 481.00 L 476.81 481.00 L 480.25 486.25 C489.34,500.11 499.19,518.77 506.75,536.50 C513.77,552.96 524.28,583.47 526.97,595.23 C532.79,620.63 534.04,626.66 535.92,638.53 C537.05,645.70 538.99,660.33 540.24,671.03 L 542.50 690.50 L 542.50 1139.00 C542.50,1576.76 542.45,1587.58 540.61,1591.00 C532.59,1605.86 514.79,1616.60 484.50,1624.85 C478.45,1626.50 471.02,1628.32 468.00,1628.90 C464.98,1629.48 459.12,1630.64 455.00,1631.48 C445.58,1633.40 419.90,1636.63 403.33,1637.97 C388.69,1639.16 335.91,1639.11 322.00,1637.89 Z";
    const pathContorno = "M 325.00 1647.96 C286.52,1645.47 245.17,1638.09 221.37,1629.48 C194.02,1619.58 178.90,1607.53 173.63,1591.45 C172.09,1586.77 171.99,1553.17 172.29,1137.45 C172.58,726.97 172.75,687.21 174.27,673.50 C178.76,632.89 185.97,597.63 196.55,564.50 C202.57,545.65 220.80,505.58 230.55,489.75 L 234.09 484.00 L 240.08 484.00 L 246.06 484.00 L 242.60 489.40 C236.25,499.34 217.00,536.65 217.00,539.03 C217.00,539.61 216.16,541.75 215.14,543.79 C212.99,548.07 205.43,569.57 201.70,582.00 C196.62,598.90 192.05,619.94 188.44,643.00 C181.70,686.00 182.03,659.99 182.01,1146.74 C182.00,1573.58 182.05,1585.11 183.88,1589.94 C187.16,1598.55 193.87,1605.02 207.00,1612.23 C219.34,1619.00 243.27,1626.61 262.50,1629.88 C265.80,1630.44 271.65,1631.56 275.50,1632.38 C298.59,1637.26 351.71,1640.46 386.00,1639.02 C405.36,1638.21 443.03,1634.31 453.46,1632.04 C455.68,1631.56 460.20,1630.62 463.18,1629.96 C474.03,1627.85 489.29,1623.87 496.00,1621.48 C520.19,1612.88 531.59,1605.55 539.19,1593.70 L 542.50 1588.55 L 542.50 1139.02 L 542.50 689.50 L 540.23 670.00 C534.15,617.63 525.63,582.44 509.25,542.00 C503.70,528.30 492.55,506.08 484.78,493.25 L 479.18 484.00 L 485.06 484.00 L 490.93 484.00 L 496.32 493.25 C501.82,502.69 502.34,503.68 509.15,517.34 C515.86,530.80 523.61,550.00 528.79,566.00 C539.67,599.56 545.09,625.98 550.71,673.00 C552.33,686.53 552.47,717.76 552.74,1137.74 L 553.03 1587.97 L 550.04 1594.57 C544.45,1606.90 535.78,1614.69 517.50,1623.77 C510.41,1627.30 494.97,1632.84 483.50,1635.98 C466.04,1640.75 428.90,1646.25 402.52,1647.96 C384.81,1649.11 342.82,1649.11 325.00,1647.96 Z";
    const pathGatilhoPrincipal = "M 235.00 483.45 C235.00,482.34 249.46,461.54 252.00,459.00 C252.27,458.73 253.92,456.67 255.65,454.44 C258.77,450.40 258.78,450.36 256.92,447.94 C255.89,446.60 254.30,443.31 253.40,440.63 C251.53,435.08 252.38,430.32 256.10,425.60 C258.69,422.30 266.47,418.27 271.92,417.40 C276.73,416.63 277.07,415.69 273.12,414.05 C271.53,413.39 268.94,411.51 267.37,409.86 C263.98,406.32 264.13,412.82 265.46,329.17 L 266.32 274.84 L 270.50 270.22 L 274.68 265.60 L 271.73 263.12 C269.07,260.88 268.83,260.19 269.27,256.07 C269.54,253.56 270.10,250.67 270.53,249.65 C271.25,247.90 270.82,247.84 262.71,248.51 C254.52,249.19 254.03,249.12 251.73,246.82 C249.72,244.81 249.14,242.76 248.17,234.17 C247.52,228.54 247.00,222.59 247.00,220.96 L 247.00 218.00 L 218.69 218.00 L 190.38 218.00 L 165.94 241.77 C100.40,305.52 55.18,347.33 47.62,351.19 C42.40,353.86 38.07,352.98 34.09,348.45 C27.98,341.49 28.60,337.70 39.42,315.97 C55.15,284.36 64.91,270.14 89.50,243.01 C108.26,222.31 113.69,214.10 120.13,196.67 C123.31,188.05 127.44,171.64 128.37,163.89 L 128.92 159.28 L 121.21 158.61 C101.25,156.88 94.85,156.03 86.50,154.01 C81.55,152.82 76.71,151.13 75.75,150.26 C71.57,146.51 68.99,126.95 68.31,94.00 C67.75,66.82 68.55,55.70 71.49,50.02 C73.84,45.47 89.31,41.82 114.00,40.00 C121.97,39.41 131.20,38.43 134.50,37.83 C142.46,36.38 201.60,36.34 214.50,37.78 C220.00,38.39 229.45,39.39 235.50,40.00 C287.52,45.27 350.63,57.90 395.50,72.04 C433.20,83.92 466.40,96.56 497.64,110.94 C527.04,124.47 542.16,133.01 565.00,148.99 C572.81,154.46 580.01,162.40 582.02,167.77 C586.97,181.01 583.28,194.26 572.06,203.53 C558.99,214.33 553.45,216.64 514.50,227.46 C480.20,236.98 464.00,245.95 457.99,258.74 C454.92,265.27 454.58,268.28 456.49,271.98 C458.68,276.22 458.87,281.20 459.43,351.24 L 459.90 408.98 L 455.61 411.49 C453.25,412.87 450.55,414.00 449.60,414.00 C446.68,414.00 448.87,415.88 452.61,416.59 C462.19,418.38 470.02,424.65 472.03,432.13 C473.35,437.00 472.58,441.09 469.30,446.72 C466.50,451.54 466.16,450.65 475.03,462.00 C481.74,470.59 490.00,482.42 490.00,483.45 C490.00,483.75 487.54,484.00 484.53,484.00 L 479.06 484.00 L 473.78 476.58 C470.88,472.49 465.18,464.85 461.13,459.59 C452.95,448.98 453.03,449.79 459.29,442.60 C463.18,438.13 463.33,434.19 459.73,430.90 C458.10,429.41 455.80,427.97 454.63,427.71 C453.46,427.45 449.80,426.54 446.50,425.70 C443.20,424.86 438.79,423.88 436.70,423.53 C432.10,422.76 428.80,418.26 429.66,413.93 C430.33,410.58 430.68,410.70 412.50,407.99 C384.73,403.85 333.81,404.43 302.75,409.24 L 295.00 410.44 L 294.97 414.47 C294.92,420.79 292.21,423.21 283.77,424.43 C275.55,425.62 265.77,429.43 263.65,432.26 C261.92,434.58 261.85,435.24 263.01,438.19 C263.73,440.01 265.83,443.11 267.69,445.08 C271.81,449.44 271.67,449.93 263.56,460.13 C260.23,464.32 254.89,471.41 251.70,475.88 L 245.90 484.00 L 240.45 484.00 C237.45,484.00 235.00,483.75 235.00,483.45 Z";
    const pathGatilhoDetalhe = "M 238.50 176.00 C236.92,174.35 235.19,173.00 234.65,173.00 C234.11,173.00 233.94,173.27 234.27,173.60 C234.60,173.93 233.66,175.27 232.19,176.57 L 229.50 178.94 L 235.44 178.97 L 241.37 179.00 L 238.50 176.00 Z";

    return (
        <div className="flex items-center justify-center h-full w-full py-2">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 621 1688"
                className="h-full w-auto max-h-[400px] drop-shadow-xl"
                preserveAspectRatio="xMidYMid meet"
            >
                <defs>
                    {/* CORREÇÃO: gradientUnits="userSpaceOnUse" 
            Permite definir as coordenadas exatas em pixels do desenho.
            y1 = 1638 (Fundo da garrafa - 0% líquido)
            y2 = 481 (Topo da garrafa - 100% líquido)
          */}
                    <linearGradient
                        id="liquidGradient"
                        gradientUnits="userSpaceOnUse"
                        x1="0" x2="0"
                        y1="1638"
                        y2="481"
                    >
                        {/* 0% a X% = Amarelo */}
                        <stop offset="0%" stopColor={colorProduct} />
                        <stop offset={`${safePercentage}%`} stopColor={colorProduct} />

                        {/* Corte seco (Hard Stop) */}
                        <stop offset={`${safePercentage}%`} stopColor={colorWater} />

                        {/* X% a 100% = Azul */}
                        <stop offset="100%" stopColor={colorWater} />
                    </linearGradient>

                    <clipPath id="bottleMask">
                        <path d={pathSolido} />
                    </clipPath>
                </defs>

                {/* 1. LÍQUIDO (Fundo) */}
                <rect
                    x="0"
                    y="0"
                    width="621"
                    height="1688"
                    fill="url(#liquidGradient)"
                    clipPath="url(#bottleMask)"
                />

                {/* 2. VIDRO (Contorno) */}
                <path
                    d={pathContorno}
                    fill="none"
                    strokeWidth="5"
                    className="stroke-black dark:stroke-zinc-400 transition-colors duration-200"
                />

                {/* 3. GATILHO (Topo) */}
                <g className="fill-black dark:fill-zinc-400 transition-colors duration-200">
                    <path d={pathGatilhoPrincipal} />
                    <path d={pathGatilhoDetalhe} />
                </g>
            </svg>
        </div>
    );
};

export default SprayBottleVisual;
